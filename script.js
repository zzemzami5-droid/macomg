
// ===== Config =====
const WHATSAPP_NUMBER_INTL = "212699289568";
const BUSINESS_PAYPAL = "szemzami@outlook.fr";

// ===== I18N =====
const i18n = {
  en: {
    tagline: "Digital Courses & Subscriptions",
    "nav.products": "Products",
    "nav.checkout": "Checkout",
    "nav.contact": "Contact",
    "nav.terms": "Terms",
    "hero.title": "Top e‑learning at the best price",
    "hero.subtitle": "edX, Coursera, Busuu, and Udemy subscriptions. Order via WhatsApp or pay with PayPal.",
    "hero.cta": "Browse Products",
    "hero.whatsapp": "Order on WhatsApp",
    "products.title": "Products",
    "products.edx.desc": "Access edX verified courses and professional certificates.",
    "products.coursera.desc": "Coursera Plus style access for top universities.",
    "products.busuu.desc": "Premium language learning with community feedback.",
    "products.udemy.desc": "Hand‑picked Udemy courses and bundles.",
    "per.month": "per year",
    "per.course": "/course",
    "actions.whatsapp": "Order via WhatsApp",
    "actions.add": "Add to Checkout",
    "products.note": "Notes: Delivery is digital. You'll receive access by email/WhatsApp after payment.",
    "checkout.title": "Checkout",
    "form.fullname": "Full name",
    "form.email": "Email",
    "form.product": "Product",
    "form.notes": "Notes (optional)",
    "checkout.whatsapp": "Order via WhatsApp",
    "checkout.paypal": "Pay with PayPal",
    "checkout.hint": "You can pay securely with PayPal or place an order on WhatsApp and pay later.",
    "terms.title": "Terms and Conditions",
    "terms.intro": "By ordering any product, you agree to the following rules:",
    "terms.digital": "Delivery is digital; you'll receive access details via email or WhatsApp after payment confirmation.",
    "terms.refund": "Payments are non-refundable once access is provided.",
    "terms.contact": "For any issues or questions, contact us via WhatsApp or email.",
    "terms.responsibility": "We are not responsible for third-party platform changes or account issues.",
    "contact.title": "Contact Us",
    "contact.intro": "Get in touch with MACOMG for your digital course subscriptions. We're here to help with any questions or orders.",
    "contact.whatsapp": "WhatsApp",
    "contact.whatsapp.desc": "Quick orders and support",
    "contact.email": "Email",
    "contact.email.desc": "For detailed inquiries",
    "contact.company": "About MACOMG",
    "contact.company.desc": "MACOMG specializes in providing access to top e-learning platforms like edX, Coursera, Busuu, and Udemy. We offer affordable subscriptions and courses to help you learn and grow.",
    "footer.rights": "All rights reserved."
  },
  fr: {
    tagline: "Cours et abonnements numériques",
    "nav.products": "Produits",
    "nav.checkout": "Paiement",
    "nav.contact": "Contact",
    "nav.terms": "Termes",
    "hero.title": "Meilleures plateformes d’apprentissage au meilleur prix",
    "hero.subtitle": "Abonnements à edX, Coursera, Busuu et Udemy. Commandez sur WhatsApp ou payez avec PayPal.",
    "hero.cta": "Voir les produits",
    "hero.whatsapp": "Commander sur WhatsApp",
    "products.title": "Produits",
    "products.edx.desc": "Accès aux cours vérifiés edX et certificats pro.",
    "products.coursera.desc": "Accès type Coursera Plus aux meilleures universités.",
    "products.busuu.desc": "Apprentissage des langues avec retours de la communauté.",
    "products.udemy.desc": "Sélection de cours et bundles Udemy.",
    "per.month": "par an",
    "per.course": "/cours",
    "actions.whatsapp": "Commander via WhatsApp",
    "actions.add": "Ajouter au panier",
    "products.note": "Notes : livraison numérique. Vous recevrez l’accès par email/WhatsApp après paiement.",
    "checkout.title": "Paiement",
    "form.fullname": "Nom complet",
    "form.email": "Email",
    "form.product": "Produit",
    "form.notes": "Notes (facultatif)",
    "checkout.whatsapp": "Commander via WhatsApp",
    "checkout.paypal": "Payer avec PayPal",
    "checkout.hint": "Payez en toute sécurité avec PayPal ou commandez sur WhatsApp et payez plus tard.",
    "terms.title": "Termes et Conditions",
    "terms.intro": "En commandant un produit, vous acceptez les règles suivantes :",
    "terms.digital": "La livraison est numérique ; vous recevrez les détails d'accès par email ou WhatsApp après confirmation du paiement.",
    "terms.refund": "Les paiements sont non remboursables une fois l'accès fourni.",
    "terms.contact": "Pour tout problème ou question, contactez-nous via WhatsApp ou email.",
    "terms.responsibility": "Nous ne sommes pas responsables des changements de plateforme tiers ou des problèmes de compte.",
    "contact.title": "Contactez-nous",
    "contact.intro": "Contactez MACOMG pour vos abonnements aux cours numériques. Nous sommes là pour vous aider avec toutes vos questions ou commandes.",
    "contact.whatsapp": "WhatsApp",
    "contact.whatsapp.desc": "Commandes rapides et support",
    "contact.email": "Email",
    "contact.email.desc": "Pour les demandes détaillées",
    "contact.company": "À propos de MACOMG",
    "contact.company.desc": "MACOMG se spécialise dans l'accès aux meilleures plateformes d'apprentissage en ligne comme edX, Coursera, Busuu et Udemy. Nous proposons des abonnements et cours abordables pour vous aider à apprendre et à grandir.",
    "footer.rights": "Tous droits réservés."
  },
  ar: {
    tagline: "دورات واشتراكات رقمية",
    "nav.products": "المنتجات",
    "nav.checkout": "الدفع",
    "nav.contact": "التواصل",
    "nav.terms": "الشروط",
    "hero.title": "أفضل منصات التعلّم بأفضل سعر",
    "hero.subtitle": "اشتراكات edX و Coursera و Busuu و Udemy. اطلب عبر واتساب أو ادفع عبر بايبال.",
    "hero.cta": "تصفح المنتجات",
    "hero.whatsapp": "اطلب عبر واتساب",
    "products.title": "المنتجات",
    "products.edx.desc": "وصول إلى دورات edX الموثّقة وشهادات مهنية.",
    "products.coursera.desc": "وصول شبيه Coursera Plus لجامعات رائدة.",
    "products.busuu.desc": "تعلم لغات مع ملاحظات المجتمع.",
    "products.udemy.desc": "دورات وباقات مختارة من Udemy.",
    "per.month": "سنويًا",
    "per.course": "/للدورة",
    "actions.whatsapp": "اطلب عبر واتساب",
    "actions.add": "أضف إلى الدفع",
    "products.note": "ملاحظات: التسليم رقمي. ستصلك بيانات الوصول عبر البريد/الواتساب بعد الدفع.",
    "checkout.title": "الدفع",
    "form.fullname": "الاسم الكامل",
    "form.email": "البريد الإلكتروني",
    "form.product": "المنتج",
    "form.notes": "ملاحظات (اختياري)",
    "checkout.whatsapp": "اطلب عبر واتساب",
    "checkout.paypal": "ادفع عبر بايبال",
    "checkout.hint": "يمكنك الدفع بأمان عبر بايبال أو الطلب عبر واتساب والدفع لاحقًا.",
    "terms.title": "الشروط والأحكام",
    "terms.intro": "بتسجيل طلب أي منتج، توافق على القواعد التالية:",
    "terms.digital": "التسليم رقمي؛ ستتلقى تفاصيل الوصول عبر البريد الإلكتروني أو واتساب بعد تأكيد الدفع.",
    "terms.refund": "المدفوعات غير قابلة للاسترداد بمجرد توفير الوصول.",
    "terms.contact": "لأي مشاكل أو أسئلة، اتصل بنا عبر واتساب أو البريد الإلكتروني.",
    "terms.responsibility": "نحن غير مسؤولين عن تغييرات المنصات الخارجية أو مشاكل الحساب.",
    "contact.title": "تواصل معنا",
    "contact.intro": "تواصل مع MACOMG لاشتراكاتك في الدورات الرقمية. نحن هنا لمساعدتك في أي أسئلة أو طلبات.",
    "contact.whatsapp": "واتساب",
    "contact.whatsapp.desc": "طلبات سريعة ودعم",
    "contact.email": "البريد الإلكتروني",
    "contact.email.desc": "للاستفسارات التفصيلية",
    "contact.company": "حول MACOMG",
    "contact.company.desc": "تتخصص MACOMG في توفير الوصول إلى أفضل منصات التعلم الإلكتروني مثل edX و Coursera و Busuu و Udemy. نقدم اشتراكات ودورات ميسورة التكلفة لمساعدتك على التعلم والنمو.",
    "footer.rights": "جميع الحقوق محفوظة."
  }
};

// ===== Language switching (desktop + mobile) =====
const langDesktopBtns = document.querySelectorAll(".lang-btn-new");
const langMenuBtns = document.querySelectorAll(".lang-btn-menu-simple");

function applyLangButtons(btns, lng){
  btns.forEach(b => {
    const active = b.dataset.lang === lng;
    b.classList.toggle("active", active);
    b.setAttribute("aria-pressed", String(active));
  });
}

function setLang(lng){
  document.documentElement.lang = lng;
  document.documentElement.dir = lng === "ar" ? "rtl" : "ltr";
  applyLangButtons(langDesktopBtns, lng);
  applyLangButtons(langMenuBtns, lng);
  const strings = i18n[lng];
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (strings[key]) el.textContent = strings[key];
  });
  // update product select options
  const select = document.getElementById("product-select");
  const opts = [
    ["edX","30","per.month"],
    ["Coursera","25","per.month"],
    ["Busuu","40","per.month"],
    ["Udemy","12","per.course"]
  ];
  if (select){
    select.innerHTML = opts.map(([name,price,suf]) => {
      const suffix = strings[suf] || "";
      return `<option value="${name}|${price}">${name} — $${price} ${suffix}</option>`
    }).join("");
  }
}

[...langDesktopBtns, ...langMenuBtns].forEach(b => b.addEventListener("click", () => setLang(b.dataset.lang)));
setLang("en");

// Year
const yearEl = document.getElementById("year");
if (yearEl) yearEl.textContent = new Date().getFullYear();

// WhatsApp order buttons on product cards
document.querySelectorAll(".whats-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const name = btn.dataset.name;
    const price = btn.dataset.price;
    const text = encodeURIComponent(`Hello MACOMG! I want to order: ${name} ($${price}). My name: ___, Email: ___`);
    window.open(`https://wa.me/${WHATSAPP_NUMBER_INTL}?text=${text}`, "_blank");
  });
});

// Add to checkout prefill
document.querySelectorAll(".add-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const name = btn.dataset.name;
    const price = btn.dataset.price;
    const select = document.getElementById("product-select");
    if (select){
      select.value = `${name}|${price}`;
      document.getElementById("order-form").scrollIntoView({behavior:"smooth"});
    }
  });
});

// Checkout actions
function readForm(){
  const fd = new FormData(document.getElementById("order-form"));
  const [product, amount] = (fd.get("product")||"edX|30").split("|");
  return {
    name: (fd.get("name")||"").trim(),
    email: (fd.get("email")||"").trim(),
    product, amount,
    notes: (fd.get("notes")||"").trim()
  };
}

const waOrderBtn = document.getElementById("whatsapp-order");
if (waOrderBtn){
  waOrderBtn.addEventListener("click", () => {
    const data = readForm();
    const lines = [
      `Hello MACOMG!`,
      `Name: ${data.name}`,
      `Email: ${data.email}`,
      `Product: ${data.product} ($${data.amount})`,
      data.notes ? `Notes: ${data.notes}` : null
    ].filter(Boolean).join("\n");
    const text = encodeURIComponent(lines);
    window.open(`https://wa.me/${WHATSAPP_NUMBER_INTL}?text=${text}`, "_blank");
  });
}

const orderForm = document.getElementById("order-form");
if (orderForm){
  orderForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const data = readForm();
    document.getElementById("pp-item").value = `${data.product} - ${data.name}`;
    document.getElementById("pp-amount").value = data.amount;
    document.getElementById("paypal-form").submit();
  });
}

// Scroll to top button
const scrollToTopBtn = document.querySelector('.scroll-to-top');
window.addEventListener('scroll', () => {
  if (!scrollToTopBtn) return;
  if (window.pageYOffset > 300) {
    scrollToTopBtn.classList.add('show');
  } else {
    scrollToTopBtn.classList.remove('show');
  }
});

// ===== Mobile menu logic =====
const hamburger = document.getElementById('hamburger-custom');
const menuPanel = document.getElementById('menu-panel');

function closeMenu(){
  if (!menuPanel) return;
  menuPanel.hidden = True = true;
  document.body.classList.remove('nav-open');
  if (hamburger) hamburger.setAttribute('aria-expanded', 'false');
}

function openMenu(){
  if (!menuPanel) return;
  menuPanel.hidden = false;
  document.body.classList.add('nav-open');
  if (hamburger) hamburger.setAttribute('aria-expanded', 'true');
}

if (hamburger && menuPanel){
  hamburger.addEventListener('click', () => {
    const isOpen = !menuPanel.hidden;
    isOpen ? closeMenu() : openMenu();
  });
  menuPanel.addEventListener('click', (e) => {
    if (e.target.tagName === 'A') closeMenu();
  });
}

// ===== New header hamburger menu logic =====
const hamburgerPro = document.querySelector('.hamburger-pro');
const navMenuPro = document.getElementById('nav-menu-pro');

function closeMenuPro(){
  if (!navMenuPro) return;
  navMenuPro.classList.remove('open');
  document.body.classList.remove('nav-open');
  if (hamburgerPro) hamburgerPro.setAttribute('aria-expanded', 'false');
}

function openMenuPro(){
  if (!navMenuPro) return;
  navMenuPro.classList.add('open');
  document.body.classList.add('nav-open');
  if (hamburgerPro) hamburgerPro.setAttribute('aria-expanded', 'true');
}

if (hamburgerPro && navMenuPro){
  hamburgerPro.addEventListener('click', () => {
    const isOpen = navMenuPro.classList.contains('open');
    isOpen ? closeMenuPro() : openMenuPro();
  });
  navMenuPro.addEventListener('click', (e) => {
    if (e.target.tagName === 'A') closeMenuPro();
  });
}
